var cov_amfglq1hx=function(){var path="/home/cong/study/fse/f18-ESN-SB2/controllers/searchHospitalsController.js",hash="5f80a90bd1915054f321999587eb141a208f97fe",Function=function(){}.constructor,global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/cong/study/fse/f18-ESN-SB2/controllers/searchHospitalsController.js",statementMap:{"0":{start:{line:1,column:14},end:{line:1,column:32}},"1":{start:{line:2,column:13},end:{line:2,column:29}},"2":{start:{line:3,column:12},end:{line:3,column:21}},"3":{start:{line:4,column:15},end:{line:4,column:42}},"4":{start:{line:5,column:11},end:{line:5,column:39}},"5":{start:{line:6,column:19},end:{line:6,column:45}},"6":{start:{line:7,column:11},end:{line:7,column:26}},"7":{start:{line:8,column:17},end:{line:8,column:39}},"8":{start:{line:9,column:16},end:{line:9,column:43}},"9":{start:{line:10,column:0},end:{line:10,column:27}},"10":{start:{line:11,column:25},end:{line:13,column:2}},"11":{start:{line:16,column:0},end:{line:66,column:1}},"12":{start:{line:17,column:2},end:{line:65,column:5}},"13":{start:{line:18,column:20},end:{line:18,column:45}},"14":{start:{line:19,column:20},end:{line:19,column:45}},"15":{start:{line:20,column:4},end:{line:20,column:27}},"16":{start:{line:21,column:4},end:{line:21,column:27}},"17":{start:{line:22,column:24},end:{line:22,column:35}},"18":{start:{line:36,column:4},end:{line:61,column:9}},"19":{start:{line:41,column:8},end:{line:59,column:9}},"20":{start:{line:43,column:29},end:{line:43,column:50}},"21":{start:{line:47,column:10},end:{line:58,column:11}},"22":{start:{line:48,column:23},end:{line:48,column:60}},"23":{start:{line:49,column:23},end:{line:49,column:60}},"24":{start:{line:50,column:29},end:{line:50,column:53}},"25":{start:{line:51,column:14},end:{line:51,column:51}},"26":{start:{line:53,column:14},end:{line:57,column:15}},"27":{start:{line:54,column:33},end:{line:54,column:121}},"28":{start:{line:56,column:18},end:{line:56,column:47}},"29":{start:{line:60,column:8},end:{line:60,column:47}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:16,column:27},end:{line:16,column:28}},loc:{start:{line:16,column:67},end:{line:66,column:1}},line:16},"1":{name:"(anonymous_1)",decl:{start:{line:17,column:21},end:{line:17,column:22}},loc:{start:{line:17,column:42},end:{line:65,column:3}},line:17},"2":{name:"(anonymous_2)",decl:{start:{line:40,column:9},end:{line:40,column:10}},loc:{start:{line:40,column:33},end:{line:61,column:7}},line:40}},branchMap:{"0":{loc:{start:{line:41,column:8},end:{line:59,column:9}},type:"if",locations:[{start:{line:41,column:8},end:{line:59,column:9}},{start:{line:41,column:8},end:{line:59,column:9}}],line:41},"1":{loc:{start:{line:53,column:14},end:{line:57,column:15}},type:"if",locations:[{start:{line:53,column:14},end:{line:57,column:15}},{start:{line:53,column:14},end:{line:57,column:15}}],line:53}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0},f:{"0":0,"1":0,"2":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"43e27e138ebf9cfc5966b082cf9a028302ed4184"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();var express=(cov_amfglq1hx.s[0]++,require('express')),router=(cov_amfglq1hx.s[1]++,express.Router());const app=(cov_amfglq1hx.s[2]++,express());const server=(cov_amfglq1hx.s[3]++,require('http').Server(app));const io=(cov_amfglq1hx.s[4]++,require('socket.io')(server));const credential=(cov_amfglq1hx.s[5]++,require('./credential.js'));var path=(cov_amfglq1hx.s[6]++,require('path'));var bodyParser=(cov_amfglq1hx.s[7]++,require('body-parser'));const Message=(cov_amfglq1hx.s[8]++,require('../model/message'));cov_amfglq1hx.s[9]++;app.use(bodyParser.json());// to support JSON-encoded bodies
const googleMapsClient=(cov_amfglq1hx.s[10]++,require('@google/maps').createClient({key:'AIzaSyDjNV-cPBtiLsLXj2i_HcHnpqib5KhQhNA'}));//rest api to create a new announcement
cov_amfglq1hx.s[11]++;module.exports.hospitals=function(bodyLongitude,bodyLattitude){cov_amfglq1hx.f[0]++;cov_amfglq1hx.s[12]++;return new Promise((resolve,reject)=>{cov_amfglq1hx.f[1]++;var lattitude=(cov_amfglq1hx.s[13]++,parseFloat(bodyLattitude));var longitude=(cov_amfglq1hx.s[14]++,parseFloat(bodyLongitude));cov_amfglq1hx.s[15]++;console.log(lattitude);cov_amfglq1hx.s[16]++;console.log(longitude);var hospital_list=(cov_amfglq1hx.s[17]++,new Array());/*var searchresult = new Array();
    var distance = new Array();
    var t;
    for(var i = 0; i < hospital_list.length; i++){
      distance[i] = Math.pow(hospital_list[i].lattitude-lattitude,2) + Math.pow(hospital_list[i].longitude-longitude,2);
    }
    distance.sort();
    for(i = 0; i < hospital_list.length; i++){
      t = Math.pow(hospital_list[i].lattitude-lattitude,2) + Math.pow(hospital_list[i].longitude-longitude,2);
      if(t < distance[3]){
        searchresult.push(hospital_list[i]);
      }
    }*/cov_amfglq1hx.s[18]++;googleMapsClient.places({query:'hospital',location:[lattitude,longitude],radius:5},function(err,response){cov_amfglq1hx.f[2]++;cov_amfglq1hx.s[19]++;if(!err){cov_amfglq1hx.b[0][0]++;//console.log(response.json.results.length);
var searchresult=(cov_amfglq1hx.s[20]++,response.json.results);//console.log(searchresult[0].formatted_address);
//console.log(searchresult[0].geometry.location.lat);
//console.log(searchresult[0].id);
cov_amfglq1hx.s[21]++;for(var i=0;i<searchresult.length;i++){var t1=(cov_amfglq1hx.s[22]++,searchresult[i].geometry.location.lat);var t2=(cov_amfglq1hx.s[23]++,searchresult[i].geometry.location.lng);var distance=(cov_amfglq1hx.s[24]++,Math.pow(t1-lattitude,2));cov_amfglq1hx.s[25]++;distance+=Math.pow(t2-longitude,2);//console.log(distance);
cov_amfglq1hx.s[26]++;if(distance<0.01){cov_amfglq1hx.b[1][0]++;var hospital=(cov_amfglq1hx.s[27]++,{id:searchresult[i].id,lattitude:t1,longitude:t2,name:searchresult[i].formatted_address});//console.log(hospital);
cov_amfglq1hx.s[28]++;hospital_list.push(hospital);}else{cov_amfglq1hx.b[1][1]++;}}}else{cov_amfglq1hx.b[0][1]++;}cov_amfglq1hx.s[29]++;resolve(JSON.stringify(hospital_list));});});};// module.exports = router